name: ğŸ¤– Actualizar Eventos (Selenium)

on:
  # Ejecutar automÃ¡ticamente
  schedule:
    # Lunes y Viernes a las 9:00 AM (hora UTC, ajusta segÃºn necesites)
    - cron: '0 9 * * 1,5'
  
  # Permitir ejecuciÃ³n manual desde GitHub
  workflow_dispatch:

jobs:
  extraer-eventos:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Descargar el repositorio
      - name: ğŸ“¥ Checkout repositorio
        uses: actions/checkout@v4
      
      # 2. Configurar Python
      - name: ğŸ Configurar Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      # 3. Instalar Chrome y ChromeDriver
      - name: ğŸŒ Instalar Chrome
        uses: browser-actions/setup-chrome@latest
        with:
          chrome-version: stable
      
      - name: ğŸ”§ Verificar Chrome
        run: |
          chrome --version
          which chrome
      
      # 4. Instalar dependencias de Python
      - name: ğŸ“¦ Instalar dependencias
        run: |
          pip install --upgrade pip
          pip install selenium beautifulsoup4 lxml
      
      # 5. Ejecutar el extractor
      - name: ğŸ­ Extraer eventos con Selenium
        run: |
          cd scripts
          python extractor_selenium.py
      
      # 6. Copiar JSON a la raÃ­z (para GitHub Pages)
      - name: ğŸ“‹ Copiar JSON a la raÃ­z
        run: |
          cp scripts/eventos_agenda.json eventos_agenda.json
      
      # 7. Subir cambios a GitHub
      - name: ğŸš€ Commit y Push
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add eventos_agenda.json scripts/eventos_agenda.json
          git diff --quiet && git diff --staged --quiet || (git commit -m "ğŸ¤– Actualizar eventos automÃ¡ticamente [Selenium]" && git push)
